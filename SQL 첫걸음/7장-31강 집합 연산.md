집합 연산
=======================
RDBMS의 창시자인 에드거 커드는 **관계형 모델**을 고안한 인물이기도 한다.      
관계형 모델을 채택한 데이터베이스를 관계형 데이터베이스라 부른다.      
      
**관계형 모델**에서의 관계형은 수학 집합론의 관계형 이론에서 유래했다.    
데이터베이스의 데이터를 집합으로 간주해 다루기 쉽게 하자는 의미이다.    
  
# 1. SQL과 집합  
벤 다이어그램에서는 하나의 원이 곧 하나의 집합이다.     
원 안에는 몇 개의 요소(값 또는 데이터)가 포함 되는데     
    
이를 데이터베이스에서는 테이블의 행이 요소에 해당한다.       
즉 테이블의 하나의 데이터 값이 벤다이어 그램의 하나의 요소를 의미한다.    
테이블의 행은 여러개가 존재할테니 벤다이어 그램에도 여러개의 요소가 있을 수 있다.    
    
```SELECT 명령```을 실행하면 반환된 결과 전체를 하나의 집합(벤다이어그램)이라고 생각하자  
    
***
# 2. UNION 합집합
합집합 : 두개의 집합을 모두 합한 것 이때 중복되는 값은 하나로 취급한다.  
예를 들면   
```
a = {1,2,3}
b = {2,10,11}

a U b -> {1,2,3,10,11}이 되는 것이다.
```

## 2.1. UNOIN
SQL에서도 이러한 집합을 나타내는 키워드가 있다.      
```UNION```은 그중에서 합집합을 나타낸다.      
예시 코드를 보자  
  
**예시**
```
_______        _______
|  a  |        |  b  |
|_____|        |_____|
|  1  |        |  2  |     
|_____|        |_____|
|  2  |        | 10  |     
|_____|        |_____|
|  3  |        | 11  |     
|_____|        |_____|
```
이를 ```UNION```을 통해 나타내보면
```
SELECT * FROM mytable1
UNION
SELECT * FROM mytable2 ;
```
**결과**
```
_______        
|  a  |        
|_____|  
|  1  |       
|_____|  
|  2  |       
|_____|  
|  3  |       
|_____|
| 10  |       
|_____|  
| 11  |       
|_____| 
```
두개의 ```SELECT 명령```을 합치는 것이기에 세미콜론```;```은 맨 마지막에 붙인다.     
정리하자면 한번의 쿼리 실행으로 두 개의 ```SELECT``` 명령이 내부적으로 실행되는 형식이다.    
그리고 이를 ```UNION```을 통해 합집합을 표현하고 있다.    
      
**중요**  
```UNION```키워드를 사용할 수 있는 조건이 있다   
1. 열 개수가 같아야한다.     
2. 열의 자료형이 같아야한다.  
    
참고로 이름은 상관 없다. 합쳐질시 처음 SELECT의 열을 사용한다.  
만약 열 개수가 다른데 합치고 싶으면 ```SELECT 열 지정 FROM```을 통해서 열의 개수를 맞춰주자  
      
그리고 ```2```같은 경우 중복되었기에 1개만 나타났는데   
중복된 값을 합치지 않고 그대로 사용하려면   
```UNION ALL```을 통해서 중복을 제거하지 않고 사용할 수있다.  
  
### 2.2. UNION과 ORDER BY
```UNION```을 통해 합집합한 결과도 정렬을 할 수 있다.    
다만 제약사항이 있다. 일단 아래의 코드를 보자    
    
**예시 1**  
```
SELECT a FROM mytable1 OREDR BY a
UNION
SELECT b FROM mytable2 ;
```   
위의 예시는 합집합 하기전에 정렬을 하려하니 에러가 발생한다.       
    
**예시 2**  
```
SELECT a FROM mytable1 
UNION
SELECT b FROM mytable2 OREDR BY b;
```   
위의 예시는 b를 정렬한다고 하는데 첫번째 SELECT은 a 이므로 합집합시 정렬하기가 힘들어진다.       
     
**올바른 예시**  
```
SELECT a AS c FROM mytable1 
UNION
SELECT b AS c mytable2 OREDR BY c;
```   
합집합시 a와 b는 합쳐진다.  
하지만 OREDER BY를 했을시 무엇을 해야할지 기준이 애매하다.    
그래서 이 둘의 이름을 ```AS c```로 하나로 묶어서    
이를 ```ORDER BY``` 해주면 정렬을 진행 시킬수 있다.  
    
결론은  
```
UNION으로 SELECT 명령을 연결하는 경우, 
가장 마지막 SELECT 명령에 대해서만 ORDER BY 구를 지정할 수 있다!
ORDER BY 구에 지정하는 열은 별명을 붙여 이름을 일치시킨다.
```
  
***
# 3. 교집합 차집합
합집합 외에도 SQL명령어에는 ```교집합```, ```차집합```을 나타내는 키워드가 있다.   
  
**구조**  
```
INTERSECT : 교집합
EXCEPTION : 차집합
```
****
```
SELECT a FROM mytable1 
INTERSECT
SELECT b mytable2 ;

SELECT a FROM mytable1 
EXCEPTION
SELECT b mytable2 ;
```
