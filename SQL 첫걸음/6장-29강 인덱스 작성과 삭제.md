인덱스 작성과 삭제
=======================
우선 맛보기 구조를 보자  
``` 
CREATE INDEX 인덱스명 ON 테이블명(열..);  
DROP INDEX 인덱스명;  
```
```CREATE```는 생성을 하는 DDL 명령이다.  
```DROP```은 삭제를 하는 DDL 명령이다.  
    
참고로 표준 SQL에는 ```CREATE INDEX``` 명령은 없다.    
인덱스 자체가 데이터베이스 제품에 의존하는 선택적인 항목으로 취급되기 때문이다.    
하지만 대표적인 데이터베이스 제품에는 모두 인덱스 구조가 도입되어 있으며,    
모두 비슷한 관리 방법으로 인덱스를 다룰 수 있다.  
  
# 1. 인덱스 작성
인덱스는 ```CREATE INDEX```명령으로 만든다.
인덱스는 제품에 따라 자료형이 다른데 각 제품마다 이름을 신경쓰도록 하자 
```
Oracle , DB2 : 스키마 객체 (데이터 베이스객체)
스키마 내에 이름이 중복되지 않도록 해야한다.
```
```
MySQL , SQL Server : 테이블내의 객체
테이블 내에 이름이 중복되지 않도록 해야한다.
```
  
인덱스를 작성할 때는 해당 인덱스가 어느 테이블의 어느 열에 관한 것인지 지정할 필요가 있다.   
**이때 열은 복수로도 지정할 수 있다.**
  
**구조**
```
CREATE INDEX 인덱스명 ON 테이블명(열1, 열2, ...);  
```
**예시**
```
CREATE INDEX myidx ON mytable(id);  
```
```예시```를 기준으로 인덱스 ```myidx```는 ```mytable```의 ```id```와 연결되는 저장장치에 색인용 데이터가 들어간다.    
참고로 인덱스도 기준이 되는 테이블의 데이터가 많으면 시간도 많이 걸리고 저장공간도 많이 소비한다.     
  
***
# 2. 인덱스 삭제
인덱스는 ```DROP INDEX``` 명령으로 삭제한다.  
다만 앞서 보여주었던 객체에 따라서 사용방법이 다르다.  
  
**스키마 객체 INDEX 삭제**
```
DROP INDEX 인덱스명;
```
스키마로서 종속적인 부분이 없으니 바로 삭제 가능하다.  
  
**테이블내의 객체 INDEX 삭제**
```
DROP INDEX 인덱스명 ON 테이블명;
```
테이블에 종속적이므로 ON 테이블로 명확히 기술해주어야 한다.
    
그럼 앞서 ```CREATE```로 작성한 예시를 삭제해보자 
  
**예시**
```
MySQL 기준

DROP INDEX myidx ON mytable;
```
   
인덱스를 작성해두면 검색이 빨라진다.    
작성한 인덱스의 열을 ```WHERE``` 구로 조건을 지정하여 ```SELECT```명령으로 검색하면 처리속도가 향상된다.    
하지만 ```INSERT```같은 경우에는 인덱스를 최신 상태로 갱신하는 처리가 늘어나므로 처리속도가 조금 떨어진다.  
그리고 인덱스로 지정한 열을 사용하지 않을 경우 인덱스는 사용되지 않는다.

***
# 3. EXPLAIN
```EXPLAIN```은 실제로 인덱스를 사용하는지 안하는지를 검색해볼 수 있는 키워드로    
기존 사용하는 SQL명령어 앞에 ```EXPLAIN```을 붙이면 된다.    
  
**예시**
```
EXPLAIN SQL명령어

EXPLAIN SELECT * FROM mytable WHERE a = 'a';

여기서 a는 인덱스로 지정한 열이다.
만약 a를 사용하지 않으면 인덱스를 사용하지 않는 것이다.

EXPLAIN SELECT * FROM mytable WHERE no > 10;
```
다만 SQL명령어는 실제로 실행 되는 것이 아니라    
어떤 상태로 실행 될지를 데이터베이스가 설명해주는 것이다.      
    
```EXPLAIN```은 사실 표준 SQL명령어가 아닌 데이터베이스 제품 의존형 명령어이다.    
하지만 어떤 데이터베이스 제품이라도 이와 비슷한 명령을 지원한다.  
  
***
# 4. 최적화
```SELECT``` 명령을 실행할 때 인덱스의 사용 여부를 선택한다.     
이는 데이터베이스 내부의 최적화에 의해 처리되는 부분이다.  
  
내부처리에서는 우선 **실행계획**을 세우고  
**실행계획**에서 '인덱스가 지정된 열이 WHERE에서 사용되니 인덱스를 사용하자'와 같은 처리가 이루어진다.  
```EXPLAIN```명령은 이 실행계획을 확인하는 명령이다.  
   
 실행계획에는 인덱스의 유무뿐만 아니라 인덱스를 사용할 것인지 여부에 대해서도   
 내부의 최적화 처리를 통해 판단한다.   
 이때 판단 기준으로 인덱스의 품질을 고려한다.    
 예를 들어 인덱스의 효율성이 떨어지면 사용을 안한다는 말이다.  
