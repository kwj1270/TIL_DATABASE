데이터베이스 설계
=======================
# 1. 데이터베이스 설계  
데이터베이스를 설계한다는 것은    
데이터베이스의 스키마 내에 테이블, 인덱스, 뷰 등의 데이터베이스 객체를 정의하는 것을 말한다.    
스키마 내에 정의한다는 뜻에서 '스키마 설계'라 불리기도 한다.  
    
데이터베이스 설계의 주된 내용은 테이블의 이름이나 열, 자료형을 결정하는 것으로  
테이블 간의 관계를 생각하면서 여러 테이블을 정의하고 작성한다.  
## 1.1. 논리명과 물리명
```
물리명 : DB내에 사용되는 테이블 이름 (개발자가 이해 할 수 있는 이름)
```
```
논리명 : 설계상 이름으로 해당 테이블을 실제로 부를 때 사용하는 이름 (클라이언트와 개발자가 이해할 수 있는 이름)
```
간단히 말하자면 물리명은 시스템 내에서 쓰이는 이름이고    
논리명은 클라이언트와 개발자 양측에서 사용하는 이름이다.    
     
예를 들면 테이블구상시 ```'상품'```이라는 논리명을 가지는 테이블을 작성하고자 한다면     
물리명은 ```'production'```이 되는 것이다.    
  
설계도나 정의서에 물리명과 논리명을 함계 기재하거나  
비고란에 논리명을 기재하는 경우도 있다.  
  
## 1.2. 자료형  
테이블의 열에는 자료형을 정의해야한다.      
수치형 데이터만 저장하는 열에는 설계시 수치형을 지정하고    
문자열형 데이터만 저장하는 열에는 설계시 문자열형을 지정한다.        
   
데이터베이스 기능으로 ```CEHECK(조건)``` 제약이 있다.     
```CHECK(조건)```는 조건에 맞지 않는 값이 들어오면 에러를 발생시킨다.     
조건은 OR , 범위 등으로 이루어진 값을 넣고자 할 때 사용한다. 그리고 조건에는 함수도 들어 갈 수있다.  
그리고 이런 OR, 범위등으로 이루어진 것들은 설계도나 정의서에 비고란에 정의 해주는 것이 좋다.    
      
## 1.3. 고정길이와 가변길이
문자열의 자료형에는 고정길이와 가변길이가 있다.  
어느 쪽으로 지정할 것인지는 저장할 데이터를 고려해 결정한다.  
  
예를 들어 제조번호 같이 자리수가 이미 정해져 있는 경우 고정길이로 정하면 된다.  
이때 문자열형이나 숫자형으로 쓸 것인지도 판단해서 사용하자.    
  
다른 예로 비고란과 같이 자주 입력되지는 않지만   
입력되는 문자열의 길이의 변동폭이 클 경우에는  가변길이 문자열이 적합하다.  
  
또한 문자열은 생각보다 저장할 수 있는 크기가 작다.  
만약 크기가 큰 데이터를 저장하고자 한다면 ```LOB```형을 사용하면 된다.(단 인덱스 지정을 못한다.)  

## 1.4. 기본키
기본키는 중복을 허용하지 않고 하나의 데이터에 무조건적으로 존재하므로 NOT NULL을 사용한다.  
기본키로 무엇을 사용할지 모를 때는 자동증가를 이용하여 간단하게 해결하는 방법이 있다.  
   
자동 증가는 ```AUTO_INCREMENT```로 데이터가 들어오면 자동으로 값을 증가시킨다.  
단, ```AUTO_INCREMENT```로 지정된 열은 ```PRIMARY KEY``` 또는 ```UNIQUE```로 유일성을 지정해야한다.  
  
앞서 무엇을 사용할지 모를 때 자동증가를 이용한다고 했는데 막상 '열'에 대한 얘기는 없다.  
이에 대해 설명하자면 인조적으로 열을 하나 만들어서 사용한다는 얘기이다.  
즉 ```PK```를 위한 열을 하나 만들고 이를 ```AUTO_INCREMENT``` 하는 것이다.  
이를 **인조키** 라고 부른다.  
  
***
# 2. ER다이어그램
테이블을 설계할 때 테이블 간의 관계를 명확히 하기 위해 설계도를 작성하는 경우가 있다.   
ER 다이어그램은 이런 경우에 널리 쓰이는 도식이다.  
  
ER의 E는 ```ENTITY```의 약자이며 R은 ```RELATIONSHIP```이다.  
앞서 배운 DB의 ```RELATION```은 테이블을 의미했지만 ER다이어그램에서는 그 의미가 다르다
```
ENTITY      :   테이블 또는 뷰
RELATION    :   PK, FK
ATTRIBUTE   :   컬럼(필드/열)
```
```

상품                      ->      논리명
___________________     
|  상품코드 (PK)   |      ->       PRIMARY KEY 
|_________________|
|      상품명      |      ->       일반 필드(열)
|_________________|
|    메이커코드    |       ->      FOREIGN KEY
|_________________|
|       가격      |       ->       일반 필드(열)
|_________________|
```
ER다이어그램에서 테이블은 네모난 사각형으로 나타내며      
그안에 기본키와 각 열 이름을 기술한다.   
이때 테이블명은 논리명을 써주는 편이 좋다.  

```
상품
___________________     
|  상품코드 (PK)   |           메이커
|_________________|           __________________
|      상품명      |     _____|    메이커코드    |  
|_________________|     |    |_________________|
|    메이커코드    |_____|    |    메이커 명     | 
|_________________|          |_________________|
|       가격      |      
|_________________|
```
개체와 개체가 서로 연계되는 경우에는 선으로 이어서 표시한다.


```
상품
___________________     
|  상품코드 (PK)   |                              메이커
|_________________|                              __________________
|      상품명      |       ______________________|    메이커코드    |  
|_________________|       |  릴레이션십  |       |_________________|
|    메이커코드    |_______|_____________|       |    메이커 명     | 
|_________________|                             |_________________|
|       가격      |      
|_________________|
```
연계(릴레이션십)를 표시할 때는 서로 몇개의 데이터 행과 연관되는지,  
즉 몇대 몇의 관계를 가지는지를 숫자나 기호로 나타낼 수 있다.(카디널리티/다중도)  
이는 매우 중요한 것으로, 여러 가지 패턴의 표기방법 중에서도 가장 기본적인 3가지를 소개한다.  
  
* 일대일 (1:1)  
* 일대다 (1:多)  
* 다대다 (多:多)  
